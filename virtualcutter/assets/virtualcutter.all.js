/* $Id: virtualcutter.all.js 269 2011-12-02 09:09:55Z thijs $
 * 
 * @file
 * VirtualCutter
 *
 * A web-based tool for making a virtual "selection" of an existing video and 
 * return a start- and end time for use in HTML5 and/or Flash players that 
 * support the Media Fragments standard.
 *
 * The VirtualCutter is developed by One Shoe (www.oneshoe.nl) for the 
 * University of Groningen (ww.rug.nl), co-funded by SURFnet (www.surfnet.nl)
 * for use in the MediaMosa project (www.mediamosa.org).
 *
 * For more information see http://www.mediamosa.org or contact SURFnet via
 * http://www.surfnet.nl or One Shoe at http://www.oneshoe.nl/contact.
 *
 * This project uses code from VideoJS and Flowplayer. VideoJS is licensed as
 * GNU Lesser General Public License, version 3 (LGPLv3) and Flowplayer is 
 * licensed under GNU General Public License, version 3 (GPLv3). As the latter
 * is more restrictive in embedding into other projects under a different 
 * license, this project is licensed under GPLv3.
 *
 * @author One Shoe - http://www.oneshoe.nl
 */

/*
 * VideoJS - HTML5 Video Player
 * v2.0.2
 * 
 * This project contains code from VideoJS. Copyright 2010 Zencoder, Inc.
 * 
 * VideoJS is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * VideoJS is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 * 
 * You should have received a copy of the GNU Lesser General Public License
 * along with VideoJS.  If not, see <http://www.gnu.org/licenses/>.
 */

/* 
 * flowplayer.js 3.2.6. The Flowplayer API
 * 
 * Copyright 2009 Flowplayer Oy
 * 
 * This file is part of Flowplayer.
 * 
 * Flowplayer is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * Flowplayer is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with Flowplayer.  If not, see <http://www.gnu.org/licenses/>.
 */
(function($){(function(window,undefined){var document=window.document;(function(){var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.JRClass=function(){},JRClass.extend=function(prop){var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];function JRClass(){!initializing&&this.init&&this.init.apply(this,arguments)}return JRClass.prototype=prototype,JRClass.constructor=JRClass,JRClass.extend=arguments.callee,JRClass}})();var VideoJS=JRClass.extend({init:function(element,setOptions){typeof element=="string"?this.video=document.getElementById(element):this.video=element,this.video.player=this,this.values={},this.elements={},this.options={autoplay:!1,preload:!0,useBuiltInControls:!1,controlsBelow:!1,controlsAtStart:!1,controlsHiding:!0,defaultVolume:.85,playerFallbackOrder:["html5","flash","links"],flashPlayer:"htmlObject",flashPlayerVersion:!1,playOnClick:!0},typeof VideoJS.options=="object"&&_V_.merge(this.options,VideoJS.options),typeof setOptions=="object"&&_V_.merge(this.options,setOptions),this.getPreloadAttribute()!==undefined&&(this.options.preload=this.getPreloadAttribute()),this.getAutoplayAttribute()!==undefined&&(this.options.autoplay=this.getAutoplayAttribute()),this.box=this.video.parentNode,this.linksFallback=this.getLinksFallback(),this.hideLinksFallback(),this.each(this.options.playerFallbackOrder,function(playerType){if(this[playerType+"Supported"]())return this[playerType+"Init"](),!0}),this.activateElement(this,"player"),this.activateElement(this.box,"box")},behaviors:{},newBehavior:function(name,activate,functions){this.behaviors[name]=activate,this.extend(functions)},activateElement:function(element,behavior){typeof element=="string"&&(element=document.getElementById(element)),this.behaviors[behavior].call(this,element)},errors:[],warnings:[],warning:function(warning){this.warnings.push(warning),this.log(warning)},history:[],log:function(event){if(!event)return;typeof event=="string"&&(event={type:event}),event.type&&this.history.push(event.type),this.history.length>=50&&this.history.shift();try{console.log(event.type)}catch(e){try{opera.postError(event.type)}catch(e){}}},setLocalStorage:function(key,value){if(!localStorage)return;try{localStorage[key]=value}catch(e){(e.code==22||e.code==1014)&&this.warning(VideoJS.warnings.localStorageFull)}},getPreloadAttribute:function(){if(typeof this.video.hasAttribute=="function"&&this.video.hasAttribute("preload")){var preload=this.video.getAttribute("preload");return preload===""||preload==="true"?"auto":preload==="false"?"none":preload}},getAutoplayAttribute:function(){if(typeof this.video.hasAttribute=="function"&&this.video.hasAttribute("autoplay")){var autoplay=this.video.getAttribute("autoplay");return autoplay==="false"?!1:!0}},bufferedPercent:function(){return this.duration()?this.buffered()[1]/this.duration():0},each:function(arr,fn){if(!arr||arr.length===0)return;for(var i=0,j=arr.length;i<j;i++)if(fn.call(this,arr[i],i))break},extend:function(obj){for(var attrname in obj)obj.hasOwnProperty(attrname)&&(this[attrname]=obj[attrname])}});VideoJS.player=VideoJS.prototype,VideoJS.player.extend({flashSupported:function(){return this.flashElement||(this.flashElement=this.getFlashElement()),this.flashElement&&this.flashPlayerVersionSupported()?!0:!1},flashInit:function(){this.replaceWithFlash(),this.element=this.flashElement,this.video.src="";var flashPlayerType=VideoJS.flashPlayers[this.options.flashPlayer];this.extend(VideoJS.flashPlayers[this.options.flashPlayer].api),flashPlayerType.init.context(this)()},getFlashElement:function(){var children=this.video.children;for(var i=0,j=children.length;i<j;i++)if(children[i].className=="vjs-flash-fallback")return children[i]},replaceWithFlash:function(){this.flashElement&&(this.box.insertBefore(this.flashElement,this.video),this.video.style.display="none")},flashPlayerVersionSupported:function(){var playerVersion=this.options.flashPlayerVersion?this.options.flashPlayerVersion:VideoJS.flashPlayers[this.options.flashPlayer].flashPlayerVersion;return VideoJS.getFlashVersion()>=playerVersion}}),VideoJS.flashPlayers={},VideoJS.flashPlayers.htmlObject={flashPlayerVersion:9,init:function(){return!0},api:{width:function(width){return width!==undefined?(this.element.width=width,this.box.style.width=width+"px",this.triggerResizeListeners(),this):this.element.width},height:function(height){return height!==undefined?(this.element.height=height,this.box.style.height=height+"px",this.triggerResizeListeners(),this):this.element.height}}},VideoJS.player.extend({linksSupported:function(){return!0},linksInit:function(){this.showLinksFallback(),this.element=this.video},getLinksFallback:function(){return this.box.getElementsByTagName("P")[0]},hideLinksFallback:function(){this.linksFallback&&(this.linksFallback.style.display="none")},showLinksFallback:function(){this.linksFallback&&(this.linksFallback.style.display="block")}}),VideoJS.merge=function(obj1,obj2,safe){for(var attrname in obj2)obj2.hasOwnProperty(attrname)&&(!safe||!obj1.hasOwnProperty(attrname))&&(obj1[attrname]=obj2[attrname]);return obj1},VideoJS.extend=function(obj){this.merge(this,obj,!0)},VideoJS.extend({setupAllWhenReady:function(options){VideoJS.options=options,VideoJS.DOMReady(VideoJS.setup)},DOMReady:function(fn){VideoJS.addToDOMReady(fn)},setup:function(videos,options){var returnSingular=!1,playerList=[],videoElement;if(!videos||videos=="All")videos=VideoJS.getVideoJSTags();else if(typeof videos!="object"||videos.nodeType==1)videos=[videos],returnSingular=!0;for(var i=0;i<videos.length;i++)typeof videos[i]=="string"?videoElement=document.getElementById(videos[i]):videoElement=videos[i],playerList.push(new VideoJS(videoElement,options));return returnSingular?playerList[0]:playerList},getVideoJSTags:function(){var videoTags=document.getElementsByTagName("video"),videoJSTags=[],videoTag;for(var i=0,j=videoTags.length;i<j;i++)videoTag=videoTags[i],videoTag.className.indexOf("video-js")!=-1&&videoJSTags.push(videoTag);return videoJSTags},browserSupportsVideo:function(){return typeof VideoJS.videoSupport!="undefined"?VideoJS.videoSupport:(VideoJS.videoSupport=!!document.createElement("video").canPlayType,VideoJS.videoSupport)},getFlashVersion:function(){if(typeof VideoJS.flashVersion!="undefined")return VideoJS.flashVersion;var version=0,desc;if(typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]=="object")desc=navigator.plugins["Shockwave Flash"].description,desc&&(typeof navigator.mimeTypes=="undefined"||!navigator.mimeTypes["application/x-shockwave-flash"]||!!navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)&&(version=parseInt(desc.match(/^.*\s+([^\s]+)\.[^\s]+\s+[^\s]+$/)[1],10));else if(typeof window.ActiveXObject!="undefined")try{var testObject=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");testObject&&(version=parseInt(testObject.GetVariable("$version").match(/^[^\s]+\s(\d+)/)[1],10))}catch(e){}return VideoJS.flashVersion=version,VideoJS.flashVersion},isIE:function(){return!1},isIPad:function(){return navigator.userAgent.match(/iPad/i)!==null},isIPhone:function(){return navigator.userAgent.match(/iPhone/i)!==null},isIOS:function(){return VideoJS.isIPhone()||VideoJS.isIPad()},iOSVersion:function(){var match=navigator.userAgent.match(/OS (\d+)_/i);if(match&&match[1])return match[1]},isAndroid:function(){return navigator.userAgent.match(/Android/i)!==null},androidVersion:function(){var match=navigator.userAgent.match(/Android (\d+)\./i);if(match&&match[1])return match[1]},warnings:{videoNotReady:"Video is not ready yet (try playing the video first).",localStorageFull:"Local Storage is Full"}}),VideoJS.isIE()&&document.createElement("video"),window.VideoJS=window._V_=VideoJS,VideoJS.player.extend({html5Supported:function(){return VideoJS.browserSupportsVideo()&&this.canPlaySource()?!0:!1},html5Init:function(){this.element=this.video,this.fixPreloading(),this.supportProgressEvents(),this.volume(localStorage&&localStorage.volume||this.options.defaultVolume),VideoJS.isIOS()?(this.options.useBuiltInControls=!0,this.iOSInterface()):VideoJS.isAndroid()&&(this.options.useBuiltInControls=!0,this.androidInterface()),this.options.useBuiltInControls||(this.video.controls=!1,this.options.controlsBelow&&_V_.addClass(this.box,"vjs-controls-below"),this.options.playOnClick&&(this.activateElement(this.video,"playToggle"),this.buildBigPlayButton(),this.buildAndActivatePoster()),this.buildStylesCheckDiv(),this.buildAndActivateSpinner(),this.buildAndActivateControlBar(),this.loadInterface(),this.getSubtitles())},canPlaySource:function(){if(this.canPlaySourceResult)return this.canPlaySourceResult;var children=this.video.children;for(var i=0,j=children.length;i<j;i++)if(children[i].tagName.toUpperCase()=="SOURCE"){var canPlay=this.video.canPlayType(children[i].type)||this.canPlayExt(children[i].src);if(canPlay=="probably"||canPlay=="maybe")return this.firstPlayableSource=children[i],this.canPlaySourceResult=!0,!0}return this.canPlaySourceResult=!1,!1},canPlayExt:function(src){if(!src)return"";var match=src.match(/\.([^\.]+)$/);if(match&&match[1]){var ext=match[1].toLowerCase();if(VideoJS.isAndroid()){if(ext=="mp4"||ext=="m4v")return"maybe"}else if(VideoJS.isIOS()&&ext=="m3u8")return"maybe"}return""},forceTheSource:function(){this.video.src=this.firstPlayableSource.src,this.video.load()},fixPreloading:function(){typeof this.video.hasAttribute=="function"&&this.video.hasAttribute("preload")&&this.video.preload!="none"?this.video.autobuffer=!0:(this.video.autobuffer=!1,this.video.preload="none")},supportProgressEvents:function(e){_V_.addListener(this.video,"progress",this.playerOnVideoProgress.context(this))},playerOnVideoProgress:function(event){this.setBufferedFromProgress(event)},setBufferedFromProgress:function(event){if(event.total>0){var newBufferEnd=event.loaded/event.total*this.duration();newBufferEnd>this.values.bufferEnd&&(this.values.bufferEnd=newBufferEnd)}},iOSInterface:function(){VideoJS.iOSVersion()<4&&this.forceTheSource(),VideoJS.isIPad()&&this.buildAndActivateSpinner()},androidInterface:function(){this.forceTheSource(),_V_.addListener(this.video,"click",function(){this.play()}),this.buildBigPlayButton(),_V_.addListener(this.bigPlayButton,"click",function(){this.play()}.context(this)),this.positionBox(),this.showBigPlayButtons()},loadInterface:function(){if(!this.stylesHaveLoaded()){this.positionRetries||(this.positionRetries=1);if(this.positionRetries++<100){setTimeout(this.loadInterface.context(this),10);return}}this.hideStylesCheckDiv(),this.showPoster(),this.video.paused!==!1&&this.showBigPlayButtons(),this.options.controlsAtStart&&this.showControlBars(),this.positionAll()},buildAndActivateControlBar:function(){this.controls=_V_.createElement("div",{className:"vjs-controls"}),this.box.appendChild(this.controls),this.activateElement(this.controls,"controlBar"),this.activateElement(this.controls,"mouseOverVideoReporter"),this.playControl=_V_.createElement("div",{className:"vjs-play-control",innerHTML:"<span></span>"}),this.controls.appendChild(this.playControl),this.activateElement(this.playControl,"playToggle"),this.progressControl=_V_.createElement("div",{className:"vjs-progress-control"}),this.controls.appendChild(this.progressControl),this.progressHolder=_V_.createElement("div",{className:"vjs-progress-holder"}),this.progressControl.appendChild(this.progressHolder),this.activateElement(this.progressHolder,"currentTimeScrubber"),this.loadProgressBar=_V_.createElement("div",{className:"vjs-load-progress"}),this.progressHolder.appendChild(this.loadProgressBar),this.activateElement(this.loadProgressBar,"loadProgressBar"),this.playProgressBar=_V_.createElement("div",{className:"vjs-play-progress"}),this.progressHolder.appendChild(this.playProgressBar),this.activateElement(this.playProgressBar,"playProgressBar"),this.timeControl=_V_.createElement("div",{className:"vjs-time-control"}),this.controls.appendChild(this.timeControl),this.currentTimeDisplay=_V_.createElement("span",{className:"vjs-current-time-display",innerHTML:"00:00"}),this.timeControl.appendChild(this.currentTimeDisplay),this.activateElement(this.currentTimeDisplay,"currentTimeDisplay"),this.timeSeparator=_V_.createElement("span",{innerHTML:" / "}),this.timeControl.appendChild(this.timeSeparator),this.durationDisplay=_V_.createElement("span",{className:"vjs-duration-display",innerHTML:"00:00"}),this.timeControl.appendChild(this.durationDisplay),this.activateElement(this.durationDisplay,"durationDisplay"),this.volumeControl=_V_.createElement("div",{className:"vjs-volume-control",innerHTML:"<div><span></span><span></span><span></span><span></span><span></span><span></span></div>"}),this.controls.appendChild(this.volumeControl),this.activateElement(this.volumeControl,"volumeScrubber"),this.volumeDisplay=this.volumeControl.children[0],this.activateElement(this.volumeDisplay,"volumeDisplay"),this.fullscreenControl=_V_.createElement("div",{className:"vjs-fullscreen-control",innerHTML:"<div><span></span><span></span><span></span><span></span></div>"}),this.controls.appendChild(this.fullscreenControl),this.activateElement(this.fullscreenControl,"fullscreenToggle")},buildAndActivatePoster:function(){this.updatePosterSource(),this.video.poster?(this.poster=document.createElement("img"),this.box.appendChild(this.poster),this.poster.src=this.video.poster,this.poster.className="vjs-poster",this.activateElement(this.poster,"poster")):this.poster=!1},buildBigPlayButton:function(){this.bigPlayButton=_V_.createElement("div",{className:"vjs-big-play-button",innerHTML:"<span></span>"}),this.box.appendChild(this.bigPlayButton),this.activateElement(this.bigPlayButton,"bigPlayButton")},buildAndActivateSpinner:function(){this.spinner=_V_.createElement("div",{className:"vjs-spinner",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>"}),this.box.appendChild(this.spinner),this.activateElement(this.spinner,"spinner")},buildStylesCheckDiv:function(){this.stylesCheckDiv=_V_.createElement("div",{className:"vjs-styles-check"}),this.stylesCheckDiv.style.position="absolute",this.box.appendChild(this.stylesCheckDiv)},hideStylesCheckDiv:function(){this.stylesCheckDiv.style.display="none"},stylesHaveLoaded:function(){return this.stylesCheckDiv.offsetHeight!=5?!1:!0},positionAll:function(){this.positionBox(),this.positionControlBars(),this.positionPoster()},positionBox:function(){this.videoIsFullScreen?(this.box.style.width="",this.element.style.height="",this.options.controlsBelow&&(this.box.style.height="",this.element.style.height=this.box.offsetHeight-this.controls.offsetHeight+"px")):(this.box.style.width=this.width()+"px",this.element.style.height=this.height()+"px",this.options.controlsBelow&&(this.element.style.height=""))},getSubtitles:function(){var tracks=this.video.getElementsByTagName("TRACK");for(var i=0,j=tracks.length;i<j;i++)tracks[i].getAttribute("kind")=="subtitles"&&tracks[i].getAttribute("src")&&(this.subtitlesSource=tracks[i].getAttribute("src"),this.loadSubtitles(),this.buildSubtitles())},loadSubtitles:function(){_V_.get(this.subtitlesSource,this.parseSubtitles.context(this))},parseSubtitles:function(subText){var lines=subText.split("\n"),line="",subtitle,time,text;this.subtitles=[],this.currentSubtitle=!1,this.lastSubtitleIndex=0;for(var i=0;i<lines.length;i++){line=_V_.trim(lines[i]);if(line){subtitle={id:line,index:this.subtitles.length},line=_V_.trim(lines[++i]),time=line.split(" --> "),subtitle.start=this.parseSubtitleTime(time[0]),subtitle.end=this.parseSubtitleTime(time[1]),text=[];for(var j=i;j<lines.length;j++){line=_V_.trim(lines[++i]);if(!line)break;text.push(line)}subtitle.text=text.join("<br/>"),this.subtitles.push(subtitle)}}},parseSubtitleTime:function(timeText){var parts=timeText.split(":"),time=0;time+=parseFloat(parts[0])*60*60,time+=parseFloat(parts[1])*60;var seconds=parts[2].split(/\.|,/);return time+=parseFloat(seconds[0]),ms=parseFloat(seconds[1]),ms&&(time+=ms/1e3),time},buildSubtitles:function(){this.subtitlesDisplay=_V_.createElement("div",{className:"vjs-subtitles"}),this.box.appendChild(this.subtitlesDisplay),this.activateElement(this.subtitlesDisplay,"subtitlesDisplay")},addVideoListener:function(type,fn){_V_.addListener(this.video,type,fn.rEvtContext(this))},play:function(){return this.video.play(),this},onPlay:function(fn){return this.addVideoListener("play",fn),this},pause:function(){return this.video.pause(),this},onPause:function(fn){return this.addVideoListener("pause",fn),this},paused:function(){return this.video.paused},currentTime:function(seconds){if(seconds!==undefined){try{this.video.currentTime=seconds}catch(e){this.warning(VideoJS.warnings.videoNotReady)}return this.values.currentTime=seconds,this}return this.video.currentTime},onCurrentTimeUpdate:function(fn){this.currentTimeListeners.push(fn)},duration:function(){return this.video.duration},buffered:function(){this.values.bufferStart===undefined&&(this.values.bufferStart=0,this.values.bufferEnd=0);if(this.video.buffered&&this.video.buffered.length>0){var newEnd=this.video.buffered.end(0);newEnd>this.values.bufferEnd&&(this.values.bufferEnd=newEnd)}return[this.values.bufferStart,this.values.bufferEnd]},volume:function(percentAsDecimal){return percentAsDecimal!==undefined?(this.values.volume=Math.max(0,Math.min(1,parseFloat(percentAsDecimal))),this.video.volume=this.values.volume,this.setLocalStorage("volume",this.values.volume),this):this.values.volume?this.values.volume:this.video.volume},onVolumeChange:function(fn){_V_.addListener(this.video,"volumechange",fn.rEvtContext(this))},width:function(width){return width!==undefined?(this.video.width=width,this.box.style.width=width+"px",this.triggerResizeListeners(),this):this.video.offsetWidth},height:function(height){return height!==undefined?(this.video.height=height,this.box.style.height=height+"px",this.triggerResizeListeners(),this):this.video.offsetHeight},supportsFullScreen:function(){return typeof this.video.webkitEnterFullScreen=="function"&&!navigator.userAgent.match("Chrome")&&!navigator.userAgent.match("Mac OS X 10.5")?!0:!1},html5EnterNativeFullScreen:function(){try{this.video.webkitEnterFullScreen()}catch(e){e.code==11&&this.warning(VideoJS.warnings.videoNotReady)}return this},enterFullScreen:function(){this.supportsFullScreen()?this.html5EnterNativeFullScreen():this.enterFullWindow()},exitFullScreen:function(){this.supportsFullScreen()||this.exitFullWindow()},enterFullWindow:function(){this.videoIsFullScreen=!0,this.docOrigOverflow=document.documentElement.style.overflow,_V_.addListener(document,"keydown",this.fullscreenOnEscKey.rEvtContext(this)),_V_.addListener(window,"resize",this.fullscreenOnWindowResize.rEvtContext(this)),document.documentElement.style.overflow="hidden",_V_.addClass(this.box,"vjs-fullscreen"),this.positionAll()},exitFullWindow:function(){this.videoIsFullScreen=!1,document.removeEventListener("keydown",this.fullscreenOnEscKey,!1),window.removeEventListener("resize",this.fullscreenOnWindowResize,!1),document.documentElement.style.overflow=this.docOrigOverflow,_V_.removeClass(this.box,"vjs-fullscreen"),this.positionAll()},onError:function(fn){return this.addVideoListener("error",fn),this},onEnded:function(fn){return this.addVideoListener("ended",fn),this}}),VideoJS.player.newBehavior("player",function(player){this.onError(this.playerOnVideoError),this.onPlay(this.playerOnVideoPlay),this.onPlay(this.trackCurrentTime),this.onPause(this.playerOnVideoPause),this.onPause(this.stopTrackingCurrentTime),this.onEnded(this.playerOnVideoEnded),this.trackBuffered(),this.onBufferedUpdate(this.isBufferFull)},{playerOnVideoError:function(event){this.log(event),this.log(this.video.error)},playerOnVideoPlay:function(event){this.hasPlayed=!0},playerOnVideoPause:function(event){},playerOnVideoEnded:function(event){this.currentTime(0),this.pause()},trackBuffered:function(){this.bufferedInterval=setInterval(this.triggerBufferedListeners.context(this),500)},stopTrackingBuffered:function(){clearInterval(this.bufferedInterval)},bufferedListeners:[],onBufferedUpdate:function(fn){this.bufferedListeners.push(fn)},triggerBufferedListeners:function(){this.isBufferFull(),this.each(this.bufferedListeners,function(listener){listener.context(this)()})},isBufferFull:function(){this.bufferedPercent()==1&&this.stopTrackingBuffered()},trackCurrentTime:function(){this.currentTimeInterval&&clearInterval(this.currentTimeInterval),this.currentTimeInterval=setInterval(this.triggerCurrentTimeListeners.context(this),100),this.trackingCurrentTime=!0},stopTrackingCurrentTime:function(){clearInterval(this.currentTimeInterval),this.trackingCurrentTime=!1},currentTimeListeners:[],triggerCurrentTimeListeners:function(late,newTime){this.each(this.currentTimeListeners,function(listener){listener.context(this)(newTime||this.currentTime())})},resizeListeners:[],onResize:function(fn){this.resizeListeners.push(fn)},triggerResizeListeners:function(){this.each(this.resizeListeners,function(listener){listener.context(this)()})}}),VideoJS.player.newBehavior("mouseOverVideoReporter",function(element){_V_.addListener(element,"mousemove",this.mouseOverVideoReporterOnMouseMove.context(this)),_V_.addListener(element,"mouseout",this.mouseOverVideoReporterOnMouseOut.context(this))},{mouseOverVideoReporterOnMouseMove:function(){this.showControlBars(),clearInterval(this.mouseMoveTimeout),this.mouseMoveTimeout=setTimeout(this.hideControlBars.context(this),4e3)},mouseOverVideoReporterOnMouseOut:function(event){var parent=event.relatedTarget;while(parent&&parent!==this.box)parent=parent.parentNode;parent!==this.box&&this.hideControlBars()}}),VideoJS.player.newBehavior("box",function(element){this.positionBox(),_V_.addClass(element,"vjs-paused"),this.activateElement(element,"mouseOverVideoReporter"),this.onPlay(this.boxOnVideoPlay),this.onPause(this.boxOnVideoPause)},{boxOnVideoPlay:function(){_V_.removeClass(this.box,"vjs-paused"),_V_.addClass(this.box,"vjs-playing")},boxOnVideoPause:function(){_V_.removeClass(this.box,"vjs-playing"),_V_.addClass(this.box,"vjs-paused")}}),VideoJS.player.newBehavior("poster",function(element){this.activateElement(element,"mouseOverVideoReporter"),this.activateElement(element,"playButton"),this.onPlay(this.hidePoster),this.onEnded(this.showPoster),this.onResize(this.positionPoster)},{showPoster:function(){if(!this.poster)return;this.poster.style.display="block",this.positionPoster()},positionPoster:function(){if(!this.poster||this.poster.style.display=="none")return;this.poster.style.height=this.height()+"px",this.poster.style.width=this.width()+"px"},hidePoster:function(){if(!this.poster)return;this.poster.style.display="none"},updatePosterSource:function(){if(!this.video.poster){var images=this.video.getElementsByTagName("img");images.length>0&&(this.video.poster=images[0].src)}}}),VideoJS.player.newBehavior("controlBar",function(element){this.controlBars||(this.controlBars=[],this.onResize(this.positionControlBars)),this.controlBars.push(element),_V_.addListener(element,"mousemove",this.onControlBarsMouseMove.context(this)),_V_.addListener(element,"mouseout",this.onControlBarsMouseOut.context(this))},{showControlBars:function(){if(!this.options.controlsAtStart&&!this.hasPlayed)return;this.each(this.controlBars,function(bar){bar.style.display="block"})},positionControlBars:function(){this.updatePlayProgressBars(),this.updateLoadProgressBars()},hideControlBars:function(){this.options.controlsHiding&&!this.mouseIsOverControls&&this.each(this.controlBars,function(bar){bar.style.display="none"})},onControlBarsMouseMove:function(){this.mouseIsOverControls=!0},onControlBarsMouseOut:function(event){this.mouseIsOverControls=!1}}),VideoJS.player.newBehavior("playToggle",function(element){this.elements.playToggles||(this.elements.playToggles=[],this.onPlay(this.playTogglesOnPlay),this.onPause(this.playTogglesOnPause)),this.elements.playToggles.push(element),_V_.addListener(element,"click",this.onPlayToggleClick.context(this))},{onPlayToggleClick:function(event){this.paused()?this.play():this.pause()},playTogglesOnPlay:function(event){this.each(this.elements.playToggles,function(toggle){_V_.removeClass(toggle,"vjs-paused"),_V_.addClass(toggle,"vjs-playing")})},playTogglesOnPause:function(event){this.each(this.elements.playToggles,function(toggle){_V_.removeClass(toggle,"vjs-playing"),_V_.addClass(toggle,"vjs-paused")})}}),VideoJS.player.newBehavior("playButton",function(element){_V_.addListener(element,"click",this.onPlayButtonClick.context(this))},{onPlayButtonClick:function(event){this.play()}}),VideoJS.player.newBehavior("pauseButton",function(element){_V_.addListener(element,"click",this.onPauseButtonClick.context(this))},{onPauseButtonClick:function(event){this.pause()}}),VideoJS.player.newBehavior("playProgressBar",function(element){this.playProgressBars||(this.playProgressBars=[],this.onCurrentTimeUpdate(this.updatePlayProgressBars)),this.playProgressBars.push(element)},{updatePlayProgressBars:function(newTime){var progress=newTime!==undefined?newTime/this.duration():this.currentTime()/this.duration();isNaN(progress)&&(progress=0),this.each(this.playProgressBars,function(bar){bar.style&&(bar.style.width=_V_.round(progress*100,2)+"%")})}}),VideoJS.player.newBehavior("loadProgressBar",function(element){this.loadProgressBars||(this.loadProgressBars=[]),this.loadProgressBars.push(element),this.onBufferedUpdate(this.updateLoadProgressBars)},{updateLoadProgressBars:function(){this.each(this.loadProgressBars,function(bar){bar.style&&(bar.style.width=_V_.round(this.bufferedPercent()*100,2)+"%")})}}),VideoJS.player.newBehavior("currentTimeDisplay",function(element){this.currentTimeDisplays||(this.currentTimeDisplays=[],this.onCurrentTimeUpdate(this.updateCurrentTimeDisplays)),this.currentTimeDisplays.push(element)},{updateCurrentTimeDisplays:function(newTime){if(!this.currentTimeDisplays)return;var time=newTime?newTime:this.currentTime();this.each(this.currentTimeDisplays,function(dis){dis.innerHTML=_V_.formatTime(time)})}}),VideoJS.player.newBehavior("durationDisplay",function(element){this.durationDisplays||(this.durationDisplays=[],this.onCurrentTimeUpdate(this.updateDurationDisplays)),this.durationDisplays.push(element)},{updateDurationDisplays:function(){if(!this.durationDisplays)return;this.each(this.durationDisplays,function(dis){this.duration()&&(dis.innerHTML=_V_.formatTime(this.duration()))})}}),VideoJS.player.newBehavior("currentTimeScrubber",function(element){_V_.addListener(element,"mousedown",this.onCurrentTimeScrubberMouseDown.rEvtContext(this))},{onCurrentTimeScrubberMouseDown:function(event,scrubber){event.preventDefault(),this.currentScrubber=scrubber,this.stopTrackingCurrentTime(),this.videoWasPlaying=!this.paused(),this.pause(),_V_.blockTextSelection(),this.setCurrentTimeWithScrubber(event),_V_.addListener(document,"mousemove",this.onCurrentTimeScrubberMouseMove.rEvtContext(this)),_V_.addListener(document,"mouseup",this.onCurrentTimeScrubberMouseUp.rEvtContext(this))},onCurrentTimeScrubberMouseMove:function(event){this.setCurrentTimeWithScrubber(event)},onCurrentTimeScrubberMouseUp:function(event){_V_.unblockTextSelection(),document.removeEventListener("mousemove",this.onCurrentTimeScrubberMouseMove,!1),document.removeEventListener("mouseup",this.onCurrentTimeScrubberMouseUp,!1),this.videoWasPlaying&&(this.play(),this.trackCurrentTime())},setCurrentTimeWithScrubber:function(event){var newProgress=_V_.getRelativePosition(event.pageX,this.currentScrubber),newTime=newProgress*this.duration();this.triggerCurrentTimeListeners(0,newTime),newTime==this.duration()&&(newTime-=.1),this.currentTime(newTime)}}),VideoJS.player.newBehavior("volumeDisplay",function(element){this.volumeDisplays||(this.volumeDisplays=[],this.onVolumeChange(this.updateVolumeDisplays)),this.volumeDisplays.push(element),this.updateVolumeDisplay(element)},{updateVolumeDisplays:function(){if(!this.volumeDisplays)return;this.each(this.volumeDisplays,function(dis){this.updateVolumeDisplay(dis)})},updateVolumeDisplay:function(display){var volNum=Math.ceil(this.volume()*6);this.each(display.children,function(child,num){num<volNum?_V_.addClass(child,"vjs-volume-level-on"):_V_.removeClass(child,"vjs-volume-level-on")})}}),VideoJS.player.newBehavior("volumeScrubber",function(element){_V_.addListener(element,"mousedown",this.onVolumeScrubberMouseDown.rEvtContext(this))},{onVolumeScrubberMouseDown:function(event,scrubber){_V_.blockTextSelection(),this.currentScrubber=scrubber,this.setVolumeWithScrubber(event),_V_.addListener(document,"mousemove",this.onVolumeScrubberMouseMove.rEvtContext(this)),_V_.addListener(document,"mouseup",this.onVolumeScrubberMouseUp.rEvtContext(this))},onVolumeScrubberMouseMove:function(event){this.setVolumeWithScrubber(event)},onVolumeScrubberMouseUp:function(event){this.setVolumeWithScrubber(event),_V_.unblockTextSelection(),document.removeEventListener("mousemove",this.onVolumeScrubberMouseMove,!1),document.removeEventListener("mouseup",this.onVolumeScrubberMouseUp,!1)},setVolumeWithScrubber:function(event){var newVol=_V_.getRelativePosition(event.pageX,this.currentScrubber);this.volume(newVol)}}),VideoJS.player.newBehavior("fullscreenToggle",function(element){},{onFullscreenToggleClick:function(event){this.videoIsFullScreen?this.exitFullScreen():this.enterFullScreen()},fullscreenOnWindowResize:function(event){this.positionControlBars()},fullscreenOnEscKey:function(event){event.keyCode==27&&this.exitFullScreen()}}),VideoJS.player.newBehavior("bigPlayButton",function(element){this.elements.bigPlayButtons||(this.elements.bigPlayButtons=[],this.onPlay(this.bigPlayButtonsOnPlay),this.onEnded(this.bigPlayButtonsOnEnded)),this.elements.bigPlayButtons.push(element),this.activateElement(element,"playButton")},{bigPlayButtonsOnPlay:function(event){this.hideBigPlayButtons()},bigPlayButtonsOnEnded:function(event){this.showBigPlayButtons()},showBigPlayButtons:function(){this.each(this.elements.bigPlayButtons,function(element){element.style.display="block"})},hideBigPlayButtons:function(){this.each(this.elements.bigPlayButtons,function(element){element.style.display="none"})}}),VideoJS.player.newBehavior("spinner",function(element){this.spinners||(this.spinners=[],_V_.addListener(this.video,"loadeddata",this.spinnersOnVideoLoadedData.context(this)),_V_.addListener(this.video,"loadstart",this.spinnersOnVideoLoadStart.context(this)),_V_.addListener(this.video,"seeking",this.spinnersOnVideoSeeking.context(this)),_V_.addListener(this.video,"seeked",this.spinnersOnVideoSeeked.context(this)),_V_.addListener(this.video,"canplay",this.spinnersOnVideoCanPlay.context(this)),_V_.addListener(this.video,"canplaythrough",this.spinnersOnVideoCanPlayThrough.context(this)),_V_.addListener(this.video,"waiting",this.spinnersOnVideoWaiting.context(this)),_V_.addListener(this.video,"stalled",this.spinnersOnVideoStalled.context(this)),_V_.addListener(this.video,"suspend",this.spinnersOnVideoSuspend.context(this)),_V_.addListener(this.video,"playing",this.spinnersOnVideoPlaying.context(this)),_V_.addListener(this.video,"timeupdate",this.spinnersOnVideoTimeUpdate.context(this))),this.spinners.push(element)},{showSpinners:function(){this.each(this.spinners,function(spinner){spinner.style.display="block"}),clearInterval(this.spinnerInterval),this.spinnerInterval=setInterval(this.rotateSpinners.context(this),100)},hideSpinners:function(){this.each(this.spinners,function(spinner){spinner.style.display="none"}),clearInterval(this.spinnerInterval)},spinnersRotated:0,rotateSpinners:function(){this.each(this.spinners,function(spinner){spinner.style.WebkitTransform="scale(0.3) rotate("+this.spinnersRotated+"deg)",spinner.style.MozTransform="scale(0.3) rotate("+this.spinnersRotated+"deg)"}),this.spinnersRotated==360&&(this.spinnersRotated=0),this.spinnersRotated+=45},spinnersOnVideoLoadedData:function(event){this.hideSpinners()},spinnersOnVideoLoadStart:function(event){this.showSpinners()},spinnersOnVideoSeeking:function(event){},spinnersOnVideoSeeked:function(event){},spinnersOnVideoCanPlay:function(event){},spinnersOnVideoCanPlayThrough:function(event){this.hideSpinners()},spinnersOnVideoWaiting:function(event){this.showSpinners()},spinnersOnVideoStalled:function(event){},spinnersOnVideoSuspend:function(event){},spinnersOnVideoPlaying:function(event){this.hideSpinners()},spinnersOnVideoTimeUpdate:function(event){this.spinner.style
.display=="block"&&this.hideSpinners()}}),VideoJS.player.newBehavior("subtitlesDisplay",function(element){this.subtitleDisplays||(this.subtitleDisplays=[],this.onCurrentTimeUpdate(this.subtitleDisplaysOnVideoTimeUpdate),this.onEnded(function(){this.lastSubtitleIndex=0}.context(this))),this.subtitleDisplays.push(element)},{subtitleDisplaysOnVideoTimeUpdate:function(time){if(this.subtitles)if(!this.currentSubtitle||this.currentSubtitle.start>=time||this.currentSubtitle.end<time){var newSubIndex=!1,reverse=this.subtitles[this.lastSubtitleIndex].start>time,i=this.lastSubtitleIndex-reverse?1:0;for(;;)if(reverse){if(i<0||this.subtitles[i].end<time)break;if(this.subtitles[i].start<time){newSubIndex=i;break}i--}else{if(i>=this.subtitles.length||this.subtitles[i].start>time)break;if(this.subtitles[i].end>time){newSubIndex=i;break}i++}newSubIndex!==!1?(this.currentSubtitle=this.subtitles[newSubIndex],this.lastSubtitleIndex=newSubIndex,this.updateSubtitleDisplays(this.currentSubtitle.text)):this.currentSubtitle&&(this.currentSubtitle=!1,this.updateSubtitleDisplays(""))}},updateSubtitleDisplays:function(val){this.each(this.subtitleDisplays,function(disp){disp.innerHTML=val})}}),VideoJS.extend({addClass:function(element,classToAdd){(" "+element.className+" ").indexOf(" "+classToAdd+" ")==-1&&(element.className=element.className===""?classToAdd:element.className+" "+classToAdd)},removeClass:function(element,classToRemove){if(element.className.indexOf(classToRemove)==-1)return;var classNames=element.className.split(/\s+/);classNames.splice(classNames.lastIndexOf(classToRemove),1),element.className=classNames.join(" ")},createElement:function(tagName,attributes){return this.merge(document.createElement(tagName),attributes)},blockTextSelection:function(){document.body.focus(),document.onselectstart=function(){return!1}},unblockTextSelection:function(){document.onselectstart=function(){return!0}},formatTime:function(secs){var seconds=Math.round(secs),minutes=Math.floor(seconds/60);return minutes=minutes<10?"0"+minutes:minutes,seconds=Math.floor(seconds%60),seconds=seconds<10?"0"+seconds:seconds,minutes+":"+seconds},getRelativePosition:function(x,relativeElement){return Math.max(0,Math.min(1,(x-this.findPosX(relativeElement))/relativeElement.offsetWidth))},findPosX:function(obj){var curleft=obj.offsetLeft;while(obj=obj.offsetParent)curleft+=obj.offsetLeft;return curleft},getComputedStyleValue:function(element,style){return window.getComputedStyle(element,null).getPropertyValue(style)},round:function(num,dec){return dec||(dec=0),Math.round(num*Math.pow(10,dec))/Math.pow(10,dec)},addListener:function(element,type,handler){element.addEventListener?element.addEventListener(type,handler,!1):element.attachEvent&&element.attachEvent("on"+type,handler)},removeListener:function(element,type,handler){element.removeEventListener?element.removeEventListener(type,handler,!1):element.attachEvent&&element.detachEvent("on"+type,handler)},get:function(url,onSuccess){typeof XMLHttpRequest=="undefined"&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(f){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(g){}throw new Error("This browser does not support XMLHttpRequest.")});var request=new XMLHttpRequest;request.open("GET",url),request.onreadystatechange=function(){request.readyState==4&&request.status==200&&onSuccess(request.responseText)}.context(this),request.send()},trim:function(string){return string.toString().replace(/^\s+/,"").replace(/\s+$/,"")},bindDOMReady:function(){if(document.readyState==="complete")return VideoJS.onDOMReady();document.addEventListener?(document.addEventListener("DOMContentLoaded",VideoJS.DOMContentLoaded,!1),window.addEventListener("load",VideoJS.onDOMReady,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",VideoJS.DOMContentLoaded),window.attachEvent("onload",VideoJS.onDOMReady))},DOMContentLoaded:function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",VideoJS.DOMContentLoaded,!1),VideoJS.onDOMReady()):document.attachEvent&&document.readyState==="complete"&&(document.detachEvent("onreadystatechange",VideoJS.DOMContentLoaded),VideoJS.onDOMReady())},DOMReadyList:[],addToDOMReady:function(fn){VideoJS.DOMIsReady?fn.call(document):VideoJS.DOMReadyList.push(fn)},DOMIsReady:!1,onDOMReady:function(){if(VideoJS.DOMIsReady)return;if(!document.body)return setTimeout(VideoJS.onDOMReady,13);VideoJS.DOMIsReady=!0;if(VideoJS.DOMReadyList){for(var i=0;i<VideoJS.DOMReadyList.length;i++)VideoJS.DOMReadyList[i].call(document);VideoJS.DOMReadyList=null}}}),VideoJS.bindDOMReady(),Function.prototype.context=function(obj){var method=this,temp=function(){return method.apply(obj,arguments)};return temp},Function.prototype.evtContext=function(obj){var method=this,temp=function(){var origContext=this;return method.call(obj,arguments[0],origContext)};return temp},Function.prototype.rEvtContext=function(obj,funcParent){if(this.hasContext===!0)return this;funcParent||(funcParent=obj);for(var attrname in funcParent)if(funcParent[attrname]==this)return funcParent[attrname]=this.evtContext(obj),funcParent[attrname].hasContext=!0,funcParent[attrname];return this.evtContext(obj)},window.jQuery&&function($){$.fn.VideoJS=function(options){return this.each(function(){VideoJS.setup(this,options)}),this},$.fn.player=function(){return this[0].player}}(jQuery),window.VideoJS=window._V_=VideoJS})(window),function(){function g(o){console.log("$f.fireEvent",[].slice.call(o))}function k(q){if(!q||typeof q!="object")return q;var o=new q.constructor;for(var p in q)q.hasOwnProperty(p)&&(o[p]=k(q[p]));return o}function m(t,q){if(!t)return;var o,p=0,r=t.length;if(r===undefined){for(o in t)if(q.call(t[o],o,t[o])===!1)break}else for(var s=t[0];p<r&&q.call(s,p,s)!==!1;s=t[++p]);return t}function c(o){return document.getElementById(o)}function i(q,p,o){return typeof p!="object"?q:(q&&p&&m(p,function(r,s){if(!o||typeof s!="function")q[r]=s}),q)}function n(s){var q=s.indexOf(".");if(q!=-1){var p=s.slice(0,q)||"*",o=s.slice(q+1,s.length),r=[];return m(document.getElementsByTagName(p),function(){this.className&&this.className.indexOf(o)!=-1&&r.push(this)}),r}}function f(o){return o=o||window.event,o.preventDefault?(o.stopPropagation(),o.preventDefault()):(o.returnValue=!1,o.cancelBubble=!0),!1}function j(q,o,p){q[o]=q[o]||[],q[o].push(p)}function e(){return"_"+(""+Math.random()).slice(2,10)}var h=function(t,r,s){var q=this,p={},u={};q.index=r,typeof t=="string"&&(t={url:t}),i(this,t,!0),m("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop".split(","),function(){var v="on"+this;if(v.indexOf("*")!=-1){v=v.slice(0,v.length-1);var w="onBefore"+v.slice(2);q[w]=function(x){return j(u,w,x),q}}q[v]=function(x){return j(u,v,x),q},r==-1&&(q[w]&&(s[w]=q[w]),q[v]&&(s[v]=q[v]))}),i(this,{onCuepoint:function(x,w){if(arguments.length==1)return p.embedded=[null,x],q;typeof x=="number"&&(x=[x]);var v=e();return p[v]=[x,w],s.isLoaded()&&s._api().fp_addCuepoints(x,r,v),q},update:function(w){i(q,w),s.isLoaded()&&s._api().fp_updateClip(w,r);var v=s.getConfig(),x=r==-1?v.clip:v.playlist[r];i(x,w,!0)},_fireEvent:function(v,y,w,A){if(v=="onLoad")return m(p,function(B,C){C[0]&&s._api().fp_addCuepoints(C[0],r,B)}),!1;A=A||q;if(v=="onCuepoint"){var z=p[y];if(z)return z[1].call(s,A,w)}y&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(v)!=-1&&(i(A,y),y.metaData&&(A.duration?A.fullDuration=y.metaData.duration:A.duration=y.metaData.duration));var x=!0;return m(u[v],function(){x=this.call(s,A,y,w)}),x}});if(t.onCuepoint){var o=t.onCuepoint;q.onCuepoint.apply(q,typeof o=="function"?[o]:o),delete t.onCuepoint}m(t,function(v,w){typeof w=="function"&&(j(u,v,w),delete t[v])}),r==-1&&(s.onCuepoint=this.onCuepoint)},l=function(p,r,q,t){var o=this,s={},u=!1;t&&i(s,t),m(r,function(v,w){typeof w=="function"&&(s[v]=w,delete r[v])}),i(this,{animate:function(y,z,x){if(!y)return o;typeof z=="function"&&(x=z,z=500);if(typeof y=="string"){var w=y;y={},y[w]=z,z=500}if(x){var v=e();s[v]=x}return z===undefined&&(z=500),r=q._api().fp_animate(p,y,z,v),o},css:function(w,x){if(x!==undefined){var v={};v[w]=x,w=v}return r=q._api().fp_css(p,w),i(o,r),o},show:function(){return this.display="block",q._api().fp_showPlugin(p),o},hide:function(){return this.display="none",q._api().fp_hidePlugin(p),o},toggle:function(){return this.display=q._api().fp_togglePlugin(p),o},fadeTo:function(y,x,w){typeof x=="function"&&(w=x,x=500);if(w){var v=e();s[v]=w}return this.display=q._api().fp_fadeTo(p,y,x,v),this.opacity=y,o},fadeIn:function(w,v){return o.fadeTo(1,w,v)},fadeOut:function(w,v){return o.fadeTo(0,w,v)},getName:function(){return p},getPlayer:function(){return q},_fireEvent:function(w,v,x){if(w=="onUpdate"){var z=q._api().fp_getPlugin(p);if(!z)return;i(o,z),delete o.methods,u||(m(z.methods,function(){var B=""+this;o[B]=function(){var C=[].slice.call(arguments),D=q._api().fp_invoke(p,B,C);return D==="undefined"||D===undefined?o:D}}),u=!0)}var A=s[w];if(A){var y=A.apply(o,v);return w.slice(0,1)=="_"&&delete s[w],y}return o}})};function b(q,G,t){var w=this,v=null,D=!1,u,s,F=[],y={},x={},E,r,p,C,o,A;i(w,{id:function(){return E},isLoaded:function(){return v!==null&&v.fp_play!==undefined&&!D},getParent:function(){return q},hide:function(H){return H&&(q.style.height="0px"),w.isLoaded()&&(v.style.height="0px"),w},show:function(){return q.style.height=A+"px",w.isLoaded()&&(v.style.height=o+"px"),w},isHidden:function(){return w.isLoaded()&&parseInt(v.style.height,10)===0},load:function(J){if(!w.isLoaded()&&w._fireEvent("onBeforeLoad")!==!1){var H=function(){u=q.innerHTML,u&&!flashembed.isSupported(G.version)&&(q.innerHTML=""),J&&(J.cached=!0,j(x,"onLoad",J)),flashembed(q,G,{config:t})},I=0;m(a,function(){this.unload(function(K){++I==a.length&&H()})})}return w},unload:function(J){if(this.isFullscreen()&&/WebKit/i.test(navigator.userAgent))return J&&J(!1),w;if(u.replace(/\s/g,"")!==""){if(w._fireEvent("onBeforeUnload")===!1)return J&&J(!1),w;D=!0;try{v&&(v.fp_close(),w._fireEvent("onUnload"))}catch(H){}var I=function(){v=null,q.innerHTML=u,D=!1,J&&J(!0)};setTimeout(I,50)}else J&&J(!1);return w},getClip:function(H){return H===undefined&&(H=C),F[H]},getCommonClip:function(){return s},getPlaylist:function(){return F},getPlugin:function(H){var J=y[H];if(!J&&w.isLoaded()){var I=w._api().fp_getPlugin(H);I&&(J=new l(H,I,w),y[H]=J)}return J},getScreen:function(){return w.getPlugin("screen")},getControls:function(){return w.getPlugin("controls")._fireEvent("onUpdate")},getLogo:function(){try{return w.getPlugin("logo")._fireEvent("onUpdate")}catch(H){}},getPlay:function(){return w.getPlugin("play")._fireEvent("onUpdate")},getConfig:function(H){return H?k(t):t},getFlashParams:function(){return G},loadPlugin:function(K,J,M,L){typeof M=="function"&&(L=M,M={});var I=L?e():"_";w._api().fp_loadPlugin(K,J,M,I);var H={};H[I]=L;var N=new l(K,null,w,H);return y[K]=N,N},getState:function(){return w.isLoaded()?v.fp_getState():-1},play:function(I,H){var J=function(){I!==undefined?w._api().fp_play(I,H):w._api().fp_play()};return w.isLoaded()?J():D?setTimeout(function(){w.play(I,H)},50):w.load(function(){J()}),w},getVersion:function(){var I="flowplayer.js 3.2.6";if(w.isLoaded()){var H=v.fp_getVersion();return H.push(I),H}return I},_api:function(){if(!w.isLoaded())throw"Flowplayer "+w.id()+" not loaded when calling an API method";return v},setClip:function(H){return w.setPlaylist([H]),w},getIndex:function(){return p},_swfHeight:function(){return v.clientHeight}}),m("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut".split(","),function(){var H="on"+this;if(H.indexOf("*")!=-1){H=H.slice(0,H.length-1);var I="onBefore"+H.slice(2);w[I]=function(J){return j(x,I,J),w}}w[H]=function(J){return j(x,H,J),w}}),m("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled".split(","),function(){var H=this;w[H]=function(J,I){if(!w.isLoaded())return w;var K=null;return J!==undefined&&I!==undefined?K=v["fp_"+H](J,I):K=J===undefined?v["fp_"+H]():v["fp_"+H](J),K==="undefined"||K===undefined?w:K}}),w._fireEvent=function(Q){typeof Q=="string"&&(Q=[Q]);var R=Q[0],O=Q[1],M=Q[2],L=Q[3],K=0;t.debug&&g(Q),!w.isLoaded()&&R=="onLoad"&&O=="player"&&(v=v||c(r),o=w._swfHeight(),m(F,function(){this._fireEvent("onLoad")}),m(y,function(S,T){T._fireEvent("onUpdate")}),s._fireEvent("onLoad"));if(R=="onLoad"&&O!="player")return;R=="onError"&&(typeof O=="string"||typeof O=="number"&&typeof M=="number")&&(O=M,M=L);if(R=="onContextMenu"){m(t.contextMenu[O],function(S,T){T.call(w)});return}if(R=="onPluginEvent"||R=="onBeforePluginEvent"){var H=O.name||O,I=y[H];if(I)return I._fireEvent("onUpdate",O),I._fireEvent(M,Q.slice(3));return}if(R=="onPlaylistReplace"){F=[];var N=0;m(O,function(){F.push(new h(this,N++,w))})}if(R=="onClipAdd"){if(O.isInStream)return;O=new h(O,M,w),F.splice(M,0,O);for(K=M+1;K<F.length;K++)F[K].index++}var P=!0;if(typeof O=="number"&&O<F.length){C=O;var J=F[O];J&&(P=J._fireEvent(R,M,L));if(!J||P!==!1)P=s._fireEvent(R,M,L,J)}return m(x[R],function(){P=this.call(w,O,M),this.cached&&x[R].splice(K,1);if(P===!1)return!1;K++}),P};function B(){$f(q)?($f(q).getParent().innerHTML="",p=$f(q).getIndex(),a[p]=w):(a.push(w),p=a.length-1),A=parseInt(q.style.height,10)||q.clientHeight,E=q.id||"fp"+e(),r=G.id||E+"_api",G.id=r,t.playerId=E,typeof t=="string"&&(t={clip:{url:t}}),typeof t.clip=="string"&&(t.clip={url:t.clip}),t.clip=t.clip||{},q.getAttribute("href",2)&&!t.clip.url&&(t.clip.url=q.getAttribute("href",2)),s=new h(t.clip,-1,w),t.playlist=t.playlist||[t.clip];var I=0;m(t.playlist,function(){var K=this;typeof K=="object"&&K.length&&(K={url:""+K}),m(t.clip,function(L,M){M!==undefined&&K[L]===undefined&&typeof M!="function"&&(K[L]=M)}),t.playlist[I]=K,K=new h(K,I,w),F.push(K),I++}),m(t,function(K,L){typeof L=="function"&&(s[K]?s[K](L):j(x,K,L),delete t[K])}),m(t.plugins,function(K,L){L&&(y[K]=new l(K,L,w))});if(!t.plugins||t.plugins.controls===undefined)y.controls=new l("controls",null,w);y.canvas=new l("canvas",null,w),u=q.innerHTML;function J(L){var K=w.hasiPadSupport&&w.hasiPadSupport();return/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!/.flv$/i.test(F[0].url)&&!K?!0:(!w.isLoaded()&&w._fireEvent("onBeforeClick")!==!1&&w.load(),f(L))}function H(){u.replace(/\s/g,"")!==""?q.addEventListener?q.addEventListener("click",J,!1):q.attachEvent&&q.attachEvent("onclick",J):(q.addEventListener&&q.addEventListener("click",f,!1),w.load())}setTimeout(H,0)}if(typeof q=="string"){var z=c(q);if(!z)throw"Flowplayer cannot access element: "+q;q=z,B()}else B()}var a=[];function d(o){this.length=o.length,this.each=function(p){m(o,p)},this.size=function(){return o.length}}window.flowplayer=window.$f=function(){var p=null,o=arguments[0];if(!arguments.length)return m(a,function(){if(this.isLoaded())return p=this,!1}),p||a[0];if(arguments.length==1)return typeof o=="number"?a[o]:o=="*"?new d(a):(m(a,function(){if(this.id()==o.id||this.id()==o||this.getParent()==o)return p=this,!1}),p);if(arguments.length>1){var t=arguments[1],q=arguments.length==3?arguments[2]:{};typeof t=="string"&&(t={src:t}),t=i({bgcolor:"#000000",version:[9,0],expressInstall:"http://static.flowplayer.org/swf/expressinstall.swf",cachebusting:!1},t);if(typeof o=="string"){if(o.indexOf(".")!=-1){var s=[];return m(n(o),function(){s.push(new b(this,k(t),k(q)))}),new d(s)}var r=c(o);return new b(r!==null?r:o,t,q)}if(o)return new b(o,t,q)}return null},i(window.$f,{fireEvent:function(){var o=[].slice.call(arguments),q=$f(o[0]);return q?q._fireEvent(o.slice(1)):null},addPlugin:function(o,p){return b.prototype[o]=p,$f},each:m,extend:i}),typeof jQuery=="function"&&(jQuery.fn.flowplayer=function(q,p){if(!arguments.length||typeof arguments[0]=="number"){var o=[];return this.each(function(){var r=$f(this);r&&o.push(r)}),arguments.length?o[arguments[0]]:new d(o)}return this.each(function(){$f(this,k(q),p?k(p):{})})})}(),function(){var h=document.all,j="http://www.adobe.com/go/getflashplayer",c=typeof jQuery=="function",e=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,b={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}});function i(m,l){if(l)for(var f in l)l.hasOwnProperty(f)&&(m[f]=l[f]);return m}function a(f,n){var m=[];for(var l in f)f.hasOwnProperty(l)&&(m[l]=n(f[l]));return m}window.flashembed=function(f,m,l){typeof f=="string"&&(f=document.getElementById(f.replace("#","")));if(!f)return;return typeof m=="string"&&(m={src:m}),new d(f,i(i({},b),m),l)};var g=i(window.flashembed,{conf:b,getVersion:function(){var m,f;try{f=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(o){try{m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=m&&m.GetVariable("$version")}catch(n){try{m=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),f=m&&m.GetVariable("$version")}catch(l){}}}return f=e.exec(f),f?[f[1],f[3]]:[0,0]},asString:function(l){if(l===null||l===undefined)return null;var f=typeof l;f=="object"&&l.push&&(f="array");switch(f){case"string":return l=l.replace(new RegExp('(["\\\\])',"g"),"\\$1"),l=l.replace(/^\s?(\d+\.?\d+)%/,"$1pct"),'"'+l+'"';case"array":return"["+a(l,function(o){return g.asString(o)}).join(",")+"]";case"function":return'"function()"';case"object":var m=[];for(var n in l)l.hasOwnProperty(n)&&m.push('"'+n+'":'+g.asString(l[n]));return"{"+m.join(",")+"}"}return String(l).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(o,l){o=i({},o);var n='<object width="'+o.width+'" height="'+o.height+'" id="'+o.id+'" name="'+o.id+'"';o.cachebusting&&(o.src+=(o.src.indexOf("?")!=-1?"&":"?")+Math.random()),o.w3c||!h?n+=' data="'+o.src+'" type="application/x-shockwave-flash"':n+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',n+=">";if(o.w3c||h)n+='<param name="movie" value="'+o.src+'" />';o.width=o.height=o.id=o.w3c=o.src=null,o.onFail=o.version=o.expressInstall=null;for(var m in o)o[m]&&(n+='<param name="'+m+'" value="'+o[m]+'" />');var p="";if(l){for(var f in l)if(l[f]){var q=l[f];p+=f+"="+(/function|object/.test(typeof q)?g.asString(q):q)+"&"}p=p.slice(0,-1),n+='<param name="flashvars" value=\''+p+"' />"}return n+="</object>",n},isSupported:function(f){return k[0]>f[0]||k[0]==f[0]&&k[1]>=f[1]}}),k=g.getVersion();function d(f,n,m){if(g.isSupported(n.version))f.innerHTML=g.getHTML(n,m);else if(n.expressInstall&&g.isSupported([6,65]))f.innerHTML=g.getHTML(i(n,{src:n.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else{f.innerHTML.replace(/\s/g,"")||(f.innerHTML="<h2>Flash version "+n.version+" or greater is required</h2><h3>"+(k[0]>0?"Your version is "+k:"You have no flash plugin installed")+"</h3>"+(f.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+j+"'>here</a></p>"),f.tagName=="A"&&(f.onclick=function(){location.href=j}));if(n.onFail){var l=n.onFail.call(this);typeof l=="string"&&(f.innerHTML=l)}}h&&(window[n.id]=document.getElementById(n.id)),i(this,{getRoot:function(){return f},getOptions:function(){return n},getConf:function(){return m},getApi:function(){return f.firstChild}})}c&&(jQuery.tools=jQuery.tools||{version:"3.2.6"},jQuery.tools.flashembed={conf:b},jQuery.fn.flashembed=function(l,f){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,l,f))})})}(),function(window,undefined){var document=window.document;(function(){var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(prop){var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}return Class.prototype=prototype,Class.constructor=Class,Class.extend=arguments.callee,Class}})();var Video=Class.extend({onProgressUpdateListeners:{high:[],medium:[],low:[]},onProgressUpdateListenerInit:!1,onMetaDataListeners:[],onBufferUpdateListeners:[],onPlayListeners:[],onPauseListeners:[],onStopListeners:[],useEndMarkListener:!1,element:null,config:{hideControls:!0,defaultAspectRatio:.5625},videoSupport:undefined,player:null,flash:!1,options:{},skipPercentage:5,init:function(element,config){$.extend(this.config,config),this.element=$(element),this.html5VideoSupport()&&!config.forceFlash&&this.canPlaySource(element)?(this.player=new VideoPlayer(element,config,this.options),this.resizePlayerArea(this.element.width())):(config.src=this.retrieveFallbackResource(element),this.player=new FlashVideoPlayer(element,config,this.options),this.flash=!0,this.resizePlayerArea(this.element.width()))},resizePlayerArea:function(w,h){!w&&!h&&(w=640,h=Math.round(w*this.config.defaultAspectRatio)),w&&!h?h=Math.round(w*this.config.defaultAspectRatio):h&&!w&&(w=Math.round(h/this.config.defaultAspectRatio)),this.element.parent().css({width:w,height:h})},html5VideoSupport:function(){return typeof this.videoSupport!="undefined"?this.videoSupport:(this.videoSupport=!!document.createElement("video").canPlayType,this.videoSupport)},isIE:VideoJS.isIE,isIPad:VideoJS.isIPad,isIPhone:VideoJS.isIPhone,isIOS:VideoJS.isIOS,iOSVersion:VideoJS.iOSVersion,isAndroid:VideoJS.isAndroid,androidVersion:VideoJS.androidVersion,canPlaySource:function(videoElement){if(this.canPlaySourceResult)return this.canPlaySourceResult;var children=videoElement.children;for(var i=0,j=children.length;i<j;i++)if(children[i].tagName.toUpperCase()=="SOURCE"){var canPlay=videoElement.canPlayType(children[i].type)||this.canPlayExt(children[i].src);if(canPlay=="probably"||canPlay=="maybe")return this.firstPlayableSource=children[i],this.canPlaySourceResult=!0,!0}return this.canPlaySourceResult=!1,!1},retrieveFallbackResource:function(videoElement){if($(videoElement).data("fallback"))return $(videoElement).data("fallback");var children=videoElement.children;for(var i=0,j=children.length;i<j;i++)if(children[i].tagName.toUpperCase()=="SOURCE"&&children[i].type.match(/(video|audio)\/(mp(2|3|4)|m4v)/i))return children[i].src;return!1},canPlayExt:function(src){if(!src)return"";var match=src.match(/\.([^\.]+)$/);if(match&&match[1]){var ext=match[1].toLowerCase();if(this.isAndroid()){if(ext=="mp4"||ext=="m4v")return"maybe"}else if(this.isIOS()&&ext=="m3u8")return"maybe"}return""},play:function(){this.useEndMarkListener=!1,this.player.play()},pause:function(){this.player.pause()},playToggle:function(){this.player.isPaused()||this.player.isStopped()?this.play():this.pause()},isPaused:function(){return this.player.isPaused()},isStopped:function(){return this.player.isStopped()},forwardVideo:function(){this.player.playAt(this.player.currentTime()+this.skipPercentage/100*this.getDuration())},rewindVideo:function(){this.player.playAt(this.player.currentTime()-this.skipPercentage/100*this.getDuration())},setVolume:function(volume){this.player.setVolume(volume)},getVolume:function(){return this.player.getVolume()},hasPlayed:function(){return this.player.hasPlayed()},getTime:function(){return this.player.currentTime()},setStartMark:function(time){this.player.options.startMark=time,this.player.updateStartMarker(this.player.options.startMark)},setEndMark:function(time){this.player.options.endMark=time,this.player.updateEndMarker(this.player.options.endMark)},getDuration:function(){return this.player.getDuration()},onPlay:function(fn){return this.onPlayListeners.length==0&&this.player.onPlay(this),this.onPlayListeners.push(fn),this},triggerOnPlayListeners:function(time){this.each(this.onPlayListeners,function(fn){fn(time)})},onPause:function(fn){return this.onPauseListeners.push(fn),this.onPauseListeners.length==1&&this.player.onPause(this),this},triggerOnPauseListeners:function(){this.each(this.onPauseListeners,function(fn){fn()})},onStop:function(fn){this.onStopListeners.push(fn),this.onStopListeners.length==1&&this.player.onStop(this)},triggerOnStopListeners:function(){this.each(this.onStopListeners,function(fn){fn()})},onProgressUpdate:function(fn,priority){switch(priority){case"high":this.onProgressUpdateListeners.high.push(fn);break;case"medium":this.onProgressUpdateListeners.medium.push(fn);break;case"low":this.onProgressUpdateListeners.low.push(fn)}return this.onProgressUpdateListenerInit||(this.player.onProgressUpdate(this),this.onProgressUpdateListenerInit=!0),this},triggerOnProgressUpdateListeners:function(time,priorities){var that=this;this.each(priorities,function(prio){that.each(that.onProgressUpdateListeners[prio],function(fn){fn(time)})})},onMetaData:function(fn){return this.onMetaDataListeners.length==0?(this.onMetaDataListeners.push(fn),this.player.onMetaData(this),this):(this.onMetaDataListeners.push(fn),this)},triggerOnMetaDataListeners:function(){this.each(this.onMetaDataListeners,function(fn){fn()})},onBufferUpdate:function(fn){return this.onBufferUpdateListeners.length==0&&this.player.onBufferUpdate(this),this.onBufferUpdateListeners.push(fn),this},triggerOnBufferUpdateListeners:function(buffered){this.each(this.onBufferUpdateListeners,function(fn){fn(buffered)})},each:function(arr,fn){if(!arr||arr.length===0)return;for(var i=0,j=arr.length;i<j;i++)if(fn.call(this,arr[i],i))break}});window.Video=window._VP_=Video}(window),function(){var initializing=!1,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(prop){var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}return Class.prototype=prototype,Class.constructor=Class,Class.extend=arguments.callee,Class}}();var VideoPlayer=Class.extend({el:null,config:null,playerConf:null,player:null,options:{},stoppedAtEndMark:!1,endMark:0,startMark:0,hasEndMarkListener:null,lastProgressListenerUpdate:{low:0,medium:0},isEnded:!1,controls:[],init:function(element,config,options){this.el=element,this.config=config,this.options=options,this.config.hideControls&&(this.config.playerConf.useBuiltInControls=!0),this.videoPlayer=new VideoJS(this.el,this.config.playerConf),this.config.hideControls&&this.hideControls()},hideControls:function(){this.videoPlayer.video.controls=!1},play:function(){this.videoPlayer.play()},pause:function(){this.videoPlayer.pause()},playAt:function(startOffset,setEndMarkListener){setEndMarkListener&&(this.useEndMarkListener=!0),this.lastProgressListenerUpdate={low:0,medium:0},this.hasPlayed()?(this.setCurrentTime(startOffset,!0),this.videoPlayer.play()):this.videoPlayer.video.readyState>0&&(this.setCurrentTime(startOffset,!0),this.videoPlayer.play());if(this.hasEndMarkListener!=null)return;var that=this;this.videoPlayer.onCurrentTimeUpdate(function(time){!that.stoppedAtEndMark&&time>=that.endMark&&time<parseInt(that.endMark)+1&&(that.videoPlayer.pause(),that.stoppedAtEndMark=!0),that.hasEndMarkListener=!0})},setCurrentTime:function(time,prepareForPlayAt){var children=this.el.children,src;for(var i=0,j=children.length;i<j;i++)children[i].tagName.toUpperCase()=="SOURCE"&&(src=children[i].src,src.indexOf("#")!=-1&&(src=src.substring(0,src.indexOf("#"))),time&&(src=src+"#t="+time),children[i].src=src);prepareForPlayAt&&this.videoPlayer.currentTime(time)},stop:function(){this.videoPlayer.pause(),this.setCurrentTime(0,!0)},setVolume:function(volume){this.videoPlayer.volume(volume/100)},getVolume:function(){return this.videoPlayer.values.volume*100},isPaused:function(){return this.videoPlayer.paused()},isStopped:function(){return this.isEnded},currentTime:function(){return this.videoPlayer.currentTime()},getDuration:function(){return this.videoPlayer.video.duration},hasPlayed:function(){return this.videoPlayer.hasPlayed==undefined?!1:!0},updateStartMarker:function(time){this.startMark=time,this.setCurrentTime(time)},updateEndMarker:function(endMark){this.endMark=endMark;if(this.hasEndMarkListener!=null)return;var that=this;this.videoPlayer.onCurrentTimeUpdate(function(time){!that.stoppedAtEndMark&&time>=that.endMark&&time<parseInt(that.endMark)+1&&(that.videoPlayer.pause(),that.stoppedAtEndMark=!0),that.hasEndMarkListener=!0})},onPlay:function(context){this.videoPlayer.onPlay(function(){context.triggerOnPlayListeners()})},onPause:function(context){this.hasPlayed()||context.triggerOnPauseListeners(),this.videoPlayer.onPause(function(){context.triggerOnPauseListeners()})},onStop:function(context){this.videoPlayer.onEnded(function(){context.triggerOnStopListeners()})},onProgressUpdate:function(context){var that=this,priorities=[];this.videoPlayer.onCurrentTimeUpdate(function(time){priorities=["high"],that.lastProgressListenerUpdate.medium+.5<=time&&(priorities.push("medium"),that.lastProgressListenerUpdate.medium=time),that.lastProgressListenerUpdate.low+1<=time&&(priorities.push("low"),that.lastProgressListenerUpdate.low=time),context.triggerOnProgressUpdateListeners(time,priorities)})},onMetaData:function(context){if(this.videoPlayer.video.readyState<1)this.videoPlayer.video.addEventListener?this.videoPlayer.video.addEventListener("loadedmetadata",function(){context.triggerOnMetaDataListeners()}):this.videoPlayer.video.attachEvent("onloadedmetadata",function(){context.triggerOnMetaDataListeners()});else{context.triggerOnMetaDataListeners();return}},onBufferUpdate:function(context){var that=this;this.videoPlayer.onBufferedUpdate(function(){context.triggerOnBufferUpdateListeners(that.videoPlayer.buffered()[1])})}}),FlashVideoPlayer=VideoPlayer.extend({el:null,config:null,stoppedAtEndMark:!1,updateTime:null,updateBufferTime:null,lastProgressListenerUpdate:{high:[],medium:[],low:[]},duration:null,isEnded:!1,init:function(element,config,options){this.el=element,this.config=config,this.options=options;var playerConf={plugins:{},version:[9,115],clip:{autoPlay:!1,autoBuffering:!0,seekableOnBegin:!0,url:config.src,rangeRequests:!0}};this.videoPlayer={},this.hideControls&&(playerConf.plugins.controls=null,playerConf.play=null),this.config.playerConfig=playerConf,this.videoPlayer=$f(this.el.parentNode,config.basePath+"/src/flowplayer/flowplayer-3.2.7.swf",playerConf).load()},playAt:function(time,setEndMarkListener){setEndMarkListener&&(this.useEndMarkListener=!0),this.lastProgressListenerUpdate={low:0,medium:0},this.pause(),this.videoPlayer.play().seek(time)},setVolume:function(volume){this.videoPlayer.setVolume(volume)},setCurrentTime:function(time){this.videoPlayer.seek(time)},getVolume:function(){return this.videoPlayer.getVolume()},isPaused:function(){return this.videoPlayer.getState()==1?!0:this.videoPlayer.isPaused()},isStopped:function(){return this.videoPlayer.getState()==5},currentTime:function(){return this.videoPlayer.getTime()},getDuration:function(){return this.duration==null&&(this.duration=this.videoPlayer.getClip().fullDuration),this.duration},hasPlayed:function(){return this.videoPlayer.getState()>1&&this.videoPlayer.getTime()>.5?!0:!1},updateStartMarker:function(time){this.options.startMark=time},updateEndMarker:function(endMark){this.options.endMark=endMark},onPlay:function(context){var that=this;this.videoPlayer.onResume(function(){that.isEnded=!1,context.triggerOnPlayListeners()}),this.videoPlayer.onStart(function(){that.isEnded=!1,context.triggerOnPlayListeners()})},onPause:function(context){var that=this;this.hasPlayed()||context.triggerOnPauseListeners(),this.videoPlayer.onPause(function(){that.isEnded=!1,context.triggerOnPauseListeners()})},onStop:function(context){var that=this;this.videoPlayer.onFinish(function(){that.isEnded=!0,context.triggerOnStopListeners()})},onProgressUpdate:function(context){var that=this,priorities=[];this.videoPlayer.onResume(function(){that.lastProgressListenerUpdate.medium=0,that.lastProgressListenerUpdate.low=0,that.updateTime=setInterval
(function(){var time=that.currentTime();that.stoppedAtEndMark&&time<that.options.endMark&&(that.stoppedAtEndMark=!1),that.useEndMarkListener&&!that.stoppedAtEndMark&&time>=that.options.endMark&&(that.videoPlayer.pause(),that.stoppedAtEndMark=!0),priorities=[],priorities.push("high"),that.lastProgressListenerUpdate.medium+.5<=time&&(priorities.push("medium"),that.lastProgressListenerUpdate.medium=time),that.lastProgressListenerUpdate.low+1<=time&&(priorities.push("low"),that.lastProgressListenerUpdate.low=time),context.triggerOnProgressUpdateListeners(time,priorities)},100)}),this.videoPlayer.onStart(function(){that.lastProgressListenerUpdate.medium=0,that.lastProgressListenerUpdate.low=0,that.updateTime=setInterval(function(){var time=that.currentTime();that.stoppedAtEndMark&&that.currentTime()<that.options.endMark&&(that.stoppedAtEndMark=!1),that.useEndMarkListener&&!that.stoppedAtEndMark&&that.currentTime()>=that.options.endMark&&(that.videoPlayer.pause(),that.stoppedAtEndMark=!0),priorities=[],priorities.push("high"),that.lastProgressListenerUpdate.medium+.5<=time&&(priorities.push("medium"),that.lastProgressListenerUpdate.medium=time),that.lastProgressListenerUpdate.low+1<=time&&(priorities.push("low"),that.lastProgressListenerUpdate.low=time)},200)}),this.videoPlayer.onPause(function(){clearInterval(that.updateTime)})},onMetaData:function(context){this.videoPlayer.onStart(function(){context.triggerOnMetaDataListeners()})},onBufferUpdate:function(context){var that=this;this.videoPlayer.onStart(function(){that.updateBufferTime=setInterval(function(){status=that.videoPlayer.getStatus(),context.triggerOnBufferUpdateListeners(status.bufferEnd),status.bufferEnd>=that.videoPlayer.getClip().duration&&clearInterval(that.updateBufferTime)},500)})}});window.onload=function(){var VirtualCutter={configuration:null,element:null,controls:null,controlsElements:{},duration:null,startMark:0,endMark:null,initMarksAtStart:!1,volumeLevel:0,hasMetaData:!1,init:function(element,configuration){typeof element=="string"?this.element=$(element)[0]:this.element=element;if(this.element==null)return;this.setLoading(),this.configuration=configuration,this.player=new Video($("video",this.element)[0],this.configuration),this.controls=$(this.element).find(".vc-controls")[0],this.configureMarkerInput(),this.buildControls();var hashParts=location.hash.substring(1).split("t=");if(hashParts.length>1){var marks=hashParts[1].split(",");this.startMark=marks[0],marks.length>1&&(this.endMark=marks[1]),this.initMarksAtStart=!0}else this.updateLinks();this.configureListeners()},buildControls:function(){this.controlsElements.playControl=_V_.createElement("div",{className:"vc-play-control control-button",innerHTML:"<span></span>",accesskey:"p"}),this.controls.appendChild(this.controlsElements.playControl),this.bindEvent(this.controlsElements.playControl,"playToggle"),this.controlsElements.rewindControl=_V_.createElement("div",{className:"vc-rewind-control control-button",innerHTML:"<span></span>",accesskey:"r"}),this.controls.appendChild(this.controlsElements.rewindControl),this.bindEvent(this.controlsElements.rewindControl,"rewind"),this.controlsElements.forwardControl=_V_.createElement("div",{className:"vc-forward-control control-button",innerHTML:"<span></span>",accesskey:"f"}),this.controls.appendChild(this.controlsElements.forwardControl),this.bindEvent(this.controlsElements.forwardControl,"forward"),this.controlsElements.progressControl=_V_.createElement("div",{className:"vc-progress-control"}),this.controlsElements.progressHolder=_V_.createElement("div",{className:"vc-progress-holder"}),this.controlsElements.progressControl.appendChild(this.controlsElements.progressHolder),this.bindEvent(this.controlsElements.progressHolder,"progressClick"),this.controlsElements.loadProgressBar=_V_.createElement("div",{className:"vc-load-progress"}),this.controlsElements.progressHolder.appendChild(this.controlsElements.loadProgressBar),this.controlsElements.playProgressBar=_V_.createElement("div",{className:"vc-play-progress"}),this.controlsElements.progressHolder.appendChild(this.controlsElements.playProgressBar),this.controlsElements.markingSpacer=_V_.createElement("div",{className:"vc-marking-spacer"}),this.controlsElements.progressControl.appendChild(this.controlsElements.markingSpacer),this.controlsElements.playHandle=_V_.createElement("div",{className:"vc-play-handle"}),this.controlsElements.progressControl.appendChild(this.controlsElements.playHandle),this.bindEvent(this.controlsElements.playHandle,"progressScrubber"),this.controlsElements.startMark=_V_.createElement("span",{className:"vc-start-mark marker"}),this.controlsElements.progressControl.appendChild(this.controlsElements.startMark),this.bindEvent(this.controlsElements.startMark,"dragMarker"),this.controlsElements.endMark=_V_.createElement("span",{className:"vc-end-mark marker"}),this.controlsElements.progressControl.appendChild(this.controlsElements.endMark),this.bindEvent(this.controlsElements.endMark,"dragMarker"),this.controls.appendChild(this.controlsElements.progressControl),this.controlsElements.timeControl=_V_.createElement("div",{className:"vc-time-control"}),this.controlsElements.currentTimeDisplay=_V_.createElement("span",{className:"vc-current-time-display",innerHTML:"00:00"}),this.controlsElements.timeControl.appendChild(this.controlsElements.currentTimeDisplay),this.controlsElements.timeSeparator=_V_.createElement("span",{innerHTML:" / "}),this.controlsElements.timeControl.appendChild(this.controlsElements.timeSeparator),this.controlsElements.durationDisplay=_V_.createElement("span",{className:"vc-duration-display",innerHTML:"00:00"}),this.controlsElements.timeControl.appendChild(this.controlsElements.durationDisplay),this.controls.appendChild(this.controlsElements.timeControl),this.controlsElements.volumeControl=_V_.createElement("div",{className:"vc-volume-control control-button",innerHTML:"<div class='volume-button'><div class='volume-holder'><span></span><div class='volume-container'><div class='volume-bar'><div class='volume-level'></div><div class='volume-handle'></div></div></div></div></div>"}),this.controls.appendChild(this.controlsElements.volumeControl),this.bindEvent($(this.controlsElements.volumeControl).find(".volume-handle"),"volumeScrubber"),this.bindEvent($(this.controlsElements.volumeControl).find(".volume-button"),"toggleMute")},setLoading:function(){$(this.element).addClass("vc-loading").removeClass("vc-loaded")},finishLoading:function(){this.hasMetaData=!0,$(this.element).addClass("vc-loaded").removeClass("vc-loading")},configureListeners:function(){var that=this;this.player.onMetaData(function(){that.duration=that.player.getDuration(),that.setDuration(),that.finishLoading(),that.setVolumeLevel(that.player.getVolume()),that.initMarksAtStart?(that.endMark&&that.setEndMark(that.endMark),that.setStartMark(that.startMark)):(that.setStartMark(0),that.setEndMark(that.duration))}),this.player.onBufferUpdate(function(time){that.updateLoadProgress(time)}),this.player.onProgressUpdate(function(time){that.updatePlayProgress(time)},"medium"),this.player.onProgressUpdate(function(time){that.updateTime(time)},"low"),this.player.onPlay(function(){$(that.element).addClass("vc-playing").removeClass("vc-paused vc-stopped")}),this.player.onPause(function(){$(that.element).addClass("vc-paused").removeClass("vc-playing vc-stopped")}),this.player.onStop(function(){$(that.element).addClass("vc-stopped").removeClass("vc-playing vc-paused"),that.player.player.playAt(0,!0),that.player.pause()})},configureMarkerInput:function(){var that=this;!this.controlsElements.startMarkInput&&!this.controlsElements.endMarkInput&&(this.controlsElements.startMarkInput=$(".txt-start-mark",this.element)[0],this.controlsElements.endMarkInput=$(".txt-end-mark",this.element)[0]),!this.controlsElements.startMarkLabel&&!this.controlsElements.endMarkLabel&&!this.controlsElements.playFromHere&&(this.controlsElements.playFromHere=$(".play-from-here"),this.controlsElements.startMarkLabel=$(".start_mark .btn-mark-start"),this.controlsElements.endMarkLabel=$(".end_mark .btn-mark-end")),this.addVCEventListener(this.controlsElements.startMarkInput,"change",function(){var parsedTime=that.fromTime(this.value);if(parsedTime>0){var time=parsedTime<that.duration?parsedTime:that.duration;time=time+2<that.endMark||that.endMark==0||that.endMark==null?time:that.endMark-2}else time=parsedTime;that.setStartMark(time)}),this.addVCEventListener(this.controlsElements.endMarkInput,"change",function(){var time=that.fromTime(this.value)<that.duration?that.fromTime(this.value):that.duration;that.setEndMark(time)}),$(this.controlsElements.startMarkLabel).click(function(){that.setStartMark(that.player.getTime())}),$(this.controlsElements.endMarkLabel).click(function(){that.setEndMark(that.player.getTime())}),$(this.controlsElements.playFromHere).click(function(){that.player.player.stoppedAtEndMark=!1,that.player.player.playAt(that.startMark,!0)})},bindEvent:function(element,action){var that=this;switch(action){case"playToggle":this.addVCEventListener(element,"click",function(){if(!that.hasMetaData)return;that.player.player.stoppedAtEndMark=!0,that.player.playToggle()});break;case"rewind":this.addVCEventListener(element,"click",function(){if(!that.hasMetaData)return;that.player.rewindVideo()});break;case"forward":this.addVCEventListener(element,"click",function(){if(!that.hasMetaData)return;that.player.forwardVideo()});break;case"progressScrubber":$(element).mousedown(function(){if(!that.hasMetaData)return;that.player.pause();var barLeftOffset=$(this).parent().offset().left,barWidth=$(this).parent().width(),offsetLeft,offsetTime;$("body").mousemove(function(event){event.pageX>barLeftOffset-40&&event.pageX<barLeftOffset+barWidth+20&&(offsetLeft=Math.min(Math.max(0,event.pageX-barLeftOffset),barWidth),offsetTime=offsetLeft/barWidth*that.duration,$(element).css("left",offsetLeft),that.updateTime(offsetTime))}),$("body").mouseup(function(){offsetTime&&that.player.player.playAt(offsetTime,!1),$(this).unbind("mousemove mouseup")})});break;case"progressClick":$(element).click(function(event){if(!that.hasMetaData)return;that.player.player.playAt(that.duration/$(element).width()*(event.clientX-$(element).offset().left),!1)});break;case"volumeScrubber":$(element).mousedown(function(){if(!that.hasMetaData)return;var barTopOffset=$(element).parent().offset().top,barHeight=$(element).parent().height();$("body").mousemove(function(event){if(event.pageY>barTopOffset)if(event.pageY<barTopOffset+barHeight){var offsetCalc=(barHeight-(event.pageY-barTopOffset))/barHeight*100;$(element).css("top",100-offsetCalc+"%"),$(element).prev().css("height",offsetCalc+"%");var levelDrop=offsetCalc;that.player.setVolume(levelDrop)}else $(element).css("top","100%"),$(element).prev().css("height","0%"),that.player.setVolume(0);else $(element).css("top","0%"),$(element).prev().css("height","100%"),that.player.setVolume(100)}),$("body").mouseup(function(){$(this).unbind("mousemove mouseup")})});break;case"toggleMute":$(element).click(function(){$(this).hasClass("muted")?($(this).removeClass("muted"),that.player.setVolume(that.volumeLevel)):($(this).addClass("muted"),that.volumeLevel=that.player.getVolume(),that.player.setVolume(0))}).children().click(function(e){return!1});break;case"dragMarker":$(element).mousedown(function(){if(!that.hasMetaData)return;var barLeftOffset=$(this).parent().offset().left,barWidth=$(this).parent().width(),offsetLeft,offsetTime;$("body").mousemove(function(event){event.pageX>barLeftOffset-40&&event.pageX<barLeftOffset+barWidth+20&&(offsetLeft=Math.min(Math.max(0,event.pageX-barLeftOffset),barWidth),offsetTime=offsetLeft/barWidth*that.duration,$(element).hasClass("vc-start-mark")?that.setStartMark(offsetTime,!0):$(element).hasClass("vc-end-mark")&&that.setEndMark(offsetTime,!0))}),$("body").mouseup(function(){$(element).hasClass("vc-start-mark")?that.setStartMark(offsetTime):$(element).hasClass("vc-end-mark")&&that.setEndMark(offsetTime),$(this).unbind("mousemove mouseup")})})}},setStartMark:function(time,dragging){dragging=dragging||!1,time=parseFloat(time);if(isNaN(time))return;time=time>this.endMark-2&&this.endMark>0?this.endMark-2:time,time=Math.min(Math.max(0,time),this.duration),this.startMark=time;var leftOffset=this.startMark*(this.controlsElements.progressHolder.offsetWidth/this.duration);leftOffset=Math.round(Math.min(Math.max(leftOffset,0),this.controlsElements.progressHolder.offsetWidth)),this.controlsElements.startMark.style.display="block",this.controlsElements.startMark.style.left=leftOffset+"px",this.controlsElements.markingSpacer.style.left=leftOffset+"px",this.player.setStartMark(this.startMark),dragging||(this.endMark?document.location.hash="t="+this.toNeatSeconds(time)+","+this.toNeatSeconds(this.endMark):this.startMark&&(document.location.hash="t="+this.toNeatSeconds(time)),this.updateLinks()),this.controlsElements.startMarkInput.value=this.toTime(this.startMark)},setEndMark:function(time,dragging){dragging=dragging||!1,time=parseFloat(time);if(isNaN(time))return;time=time<this.startMark+2?this.startMark+2:time,time=Math.min(Math.max(0,time),this.duration),this.endMark=time;var leftOffset=time*(this.controlsElements.progressHolder.offsetWidth/this.duration);leftOffset=Math.min(Math.round(Math.max(leftOffset,0)),this.controlsElements.progressHolder.offsetWidth),this.controlsElements.endMark.style.display="block",this.controlsElements.endMark.style.left=leftOffset+"px",this.controlsElements.markingSpacer.style.right=Math.max(0,this.controlsElements.progressHolder.offsetWidth-leftOffset)+"px",this.player.setEndMark(time),dragging||(document.location.hash="t="+this.toNeatSeconds(this.startMark)+","+this.toNeatSeconds(this.endMark),this.updateLinks()),this.controlsElements.endMarkInput.value=this.toTime(time)},updateLoadProgress:function(time){$(this.controlsElements.loadProgressBar).css("width",time/this.duration*100+"%")},updatePlayProgress:function(time){playProgress=time/this.duration*100,$(this.controlsElements.playProgressBar).css("width",playProgress+"%"),$(this.controlsElements.playHandle).css("left",playProgress+"%")},updateTime:function(time){this.controlsElements.currentTimeDisplay.innerHTML=this.toTime(time,!0)},setDuration:function(){this.controlsElements.durationDisplay.innerHTML=this.toTime(this.duration,!0)},replaceTokens:function(str,replacements){var k;for(k in replacements)str=str.replace("{%"+k+"%}",replacements[k]);return str},updateLinks:function(){var url=this.configuration.vc_share_url||location.toString(),timec=[];this.startMark>0&&!isNaN(this.startMark)&&(this.endMark==0||this.endMark==null||isNaN(this.endMark))?(url=location.toString().split("#")[0]+"#t="+this.toNeatSeconds(this.startMark),timec.push(this.toNeatSeconds(this.startMark))):!isNaN(this.startMark)&&!isNaN(this.endMark)&&(timec.push(this.toNeatSeconds(this.startMark)),timec.push(this.toNeatSeconds(this.endMark))),url=this.replaceTokens(url,{timecode:timec.join(",")});var embed=this.configuration.vc_share_embed||'<iframe src="'+url+'" width="100%" height="100%" frameborder="0"></iframe>';embed=this.replaceTokens(embed,{playback_url:url,timecode:timec.join(",")}),$(".txt-share-embed",this.element).val(embed),$(".txt-share-url",this.element).val(url)},setVolumeLevel:function(volumeLevel){$(this.controlsElements.volumeControl).find(".volume-handle").css("top",100-volumeLevel+"%"),$(this.controlsElements.volumeControl).find(".volume-level").css("height",volumeLevel+"%"),volumeLevel==0?this.player.setVolume(0):volumeLevel&&this.player.setVolume(volumeLevel)},hasClass:function(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))},addClass:function(ele,cls){this.hasClass(ele,cls)||(ele.className+=" "+cls)},removeClass:function(ele,cls){if(this.hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");ele.className=ele.className.replace(reg," ")}},toNeatSeconds:function(input){return isNaN(input)?!1:Math.round(input*100)/100},toTime:function(input,noMs){input=parseFloat(input),isNaN(input)&&(input=0);var min=Math.floor(input/60);input-=min*60;var sec=Math.floor(input),ms=Math.round((input-sec)*100);return this.pad(min)+":"+this.pad(sec)+(noMs?"":":"+this.pad(ms))},fromTime:function(timeInFormat){var result=0,timeParts=timeInFormat.split(":");return timeParts.length==3&&parseInt(timeParts[0])>=0&&parseInt(timeParts[1])>=0&&parseInt(timeParts[2])>=0&&(result=parseInt(timeParts[0])*60+parseInt(timeParts[1])+parseInt(timeParts[2])/100),isNaN(result)?0:result},pad:function(val){return val=parseInt(val,10),val<10?"0"+val:val},addVCEventListener:function(element,event,fn){element.addEventListener?element.addEventListener(event,function(){fn.call(element)},!0):element.attachEvent("on"+event,function(){fn.call(element)})}},virtualCutterConf={hideControls:!0,playerConf:{defaultVolume:1,flashVersion:9,linksHiding:!0,playOnClick:!0},basePath:"./assets",vc_share_url:"",vc_share_embed:"",vc_duration:!1};window.location.href.indexOf("?forceFlash")!==-1&&(virtualCutterConf.forceFlash=!0),typeof Drupal!="undefined"?(virtualCutterConf.basePath=Drupal.settings.vc_basepath,typeof Drupal.settings.vc_ratio!="undefined"&&(virtualCutterConf.defaultAspectRatio=Drupal.settings.vc_ratio),typeof Drupal.settings.vc_duration!="undefined"&&(virtualCutterConf.vc_duration=Drupal.settings.vc_duration),typeof Drupal.settings.vc_share_url!="undefined"&&(virtualCutterConf.vc_share_url=Drupal.settings.vc_share_url,virtualCutterConf.vc_share_embed=Drupal.settings.vc_share_embed),$(document).ready(function(){VirtualCutter.init($("#virtualcutter"),virtualCutterConf)})):VirtualCutter.init("#virtualcutter",virtualCutterConf)}}(jQuery));